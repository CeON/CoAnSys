#!/bin/bash

# command-line parameters
LOCAL_BWNDATA_SEQUENCE_FILE=$1
TABLE_NAME=$2
TABLE_REGION_CNT=$3
MOVE_TO_HDFS=$4

# default parameters
COLLECTION_SEQUENCE_FILE_HDFS_DIR=${TABLE_NAME}_sf
TABLE_HFILES_HDFS_DIR=${TABLE_NAME}_hfiles

time ./create-presplited-table.sh ${LOCAL_BWNDATA_SEQUENCE_FILE} ${COLLECTION_SEQUENCE_FILE_HDFS_DIR} hbasekeys ${TABLE_NAME} m:c ${TABLE_REGION_CNT} ${MOVE_TO_HDFS}
hadoop fs -put 
time ./bulkload-sequence-file.sh all ${COLLECTION_SEQUENCE_FILE_HDFS_DIR} ${TABLE_HFILES_HDFS_DIR} ${TABLE_NAME}
